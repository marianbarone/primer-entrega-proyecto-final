(()=>{"use strict";var t,e,r,n={562:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,s){function i(t){try{a(n.next(t))}catch(t){s(t)}}function u(t){try{a(n.throw(t))}catch(t){s(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(i,u)}a((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},s=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,s=e.length;o<s;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.deleteById=e.updateProduct=e.getById=e.addProducts=e.getProducts=void 0;var u=i(r(147));e.getProducts=function(){return n(void 0,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,u.default.promises.readFile("../../scr/db/products.txt","utf-8")];case 1:return t=e.sent(),[2,JSON.parse(t)];case 2:return e.sent(),console.log("No existen productos"),[3,3];case 3:return[2]}}))}))},e.addProducts=function(t,e){return n(void 0,void 0,void 0,(function(){var r,n,s,i,a,c,d,l,p,f,h,b,v,m;return o(this,(function(o){switch(o.label){case 0:return[4,u.default.promises.readFile("../../scr/db/products.txt","utf-8")];case 1:return r=o.sent(),0===(n=JSON.parse(r)).length?(a=1,s=t.body,d=s.title,l=s.description,p=s.code,f=s.price,h=s.thumbnail,b=s.timestamp,v=s.stock,console.log(t.body),m=n.push({title:d,description:l,code:p,price:f,thumbnail:h,timestamp:b,stock:v,id:a}),e.json(m)):n.length>0&&(i=n[r.length-1].id,a=i+1,c=t.body,d=c.title,l=c.description,p=c.code,f=c.price,h=c.thumbnail,b=c.timestamp,v=c.stock,m=n.push({title:d,description:l,code:p,price:f,thumbnail:h,timestamp:b,stock:v,id:a}),e.json(m)),[2]}}))}))},e.getById=function(t,e){return n(void 0,void 0,void 0,(function(){var r,n,s,i;return o(this,(function(o){switch(o.label){case 0:return[4,u.default.promises.readFile("../../scr/db/products.txt","utf-8")];case 1:return r=o.sent(),n=JSON.parse(r),s=Number(t.params.id),n.length>0?isNaN(s)?e.status(400).json({error:"El ID debe ser un número!"}):(i=n.find((function(t){return t.id===s})))?e.status(200).json(i):e.status(404).json({error:"Producto no encontrado!"}):e.status(404).json({error:"No existen productos"}),[2]}}))}))},e.updateProduct=function(t,e){return n(void 0,void 0,void 0,(function(){var r,n,i,a,c,d,l,p,f,h;return o(this,(function(o){switch(o.label){case 0:return[4,u.default.promises.readFile("../../scr/db/products.txt","utf-8")];case 1:return r=o.sent(),n=JSON.parse(r),i=Number(t.params.id),n.length>0?isNaN(i)?e.status(400).json({error:"El ID debe ser un número"}):(a=n.find((function(t){return t.id==i})),c=n.filter((function(t){return t.id!==i})),a?(d=t.body,l=d.title,p=d.price,f=d.thumbnail,h={id:i,title:l,price:Number(p),thumbnail:f},n=s(s([],c,!0),[h],!1),e.status(200).send("Producto actualizada!")):e.status(404).json({error:"Producto no encontrada"})):e.status(404).json({error:"No existen productos"}),[2]}}))}))},e.deleteById=function(t,e){return n(void 0,void 0,void 0,(function(){var r,n,s,i;return o(this,(function(o){switch(o.label){case 0:return[4,u.default.promises.readFile("../../scr/db/products.txt","utf-8")];case 1:return r=o.sent(),n=JSON.parse(r),s=Number(t.params.id),n.length>0?isNaN(s)?e.status(400).json({error:"El ID debe ser un número"}):(i=n.filter((function(e){return e.id!=t.params.id})),n=i,e.status(200).send("Película eliminada!")):e.status(404).json({error:"No existen películas"}),[2]}}))}))}},860:t=>{t.exports=require("express")},147:t=>{t.exports=require("fs")}},o={};function s(t){var e=o[t];if(void 0!==e)return e.exports;var r=o[t]={exports:{}};return n[t].call(r.exports,r,r.exports,s),r.exports}t=s(562),r=function(t,e,r){return r()},(e=(0,s(860).Router)()).get("/products",t.getProducts),e.get("/products/:id",t.getById),e.post("/products",r,t.addProducts),e.put("/products/:id",r,t.updateProduct),e.delete("/products/:id",r,t.deleteById)})();