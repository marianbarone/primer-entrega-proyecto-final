(()=>{"use strict";var t={562:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,s){function u(t){try{a(n.next(t))}catch(t){s(t)}}function i(t){try{a(n.throw(t))}catch(t){s(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(u,i)}a((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,s,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,n=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){u=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){u.label=s[1];break}if(6===s[0]&&u.label<o[1]){u.label=o[1],o=s;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(s);break}o[2]&&u.ops.pop(),u.trys.pop();continue}s=e.call(t,u)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},s=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,s=e.length;o<s;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.deleteById=e.updateProduct=e.getById=e.addProducts=e.getProducts=void 0;var i=u(r(147));e.getProducts=function(){return n(void 0,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,i.default.promises.readFile("../../scr/db/products.txt","utf-8")];case 1:return t=e.sent(),[2,JSON.parse(t)];case 2:return e.sent(),console.log("No existen productos"),[3,3];case 3:return[2]}}))}))},e.addProducts=function(t,e){return n(void 0,void 0,void 0,(function(){var r,n,s,u,a,c,d,l,p,f,h,v,b,m;return o(this,(function(o){switch(o.label){case 0:return[4,i.default.promises.readFile("../../scr/db/products.txt","utf-8")];case 1:return r=o.sent(),0===(n=JSON.parse(r)).length?(a=1,s=t.body,d=s.title,l=s.description,p=s.code,f=s.price,h=s.thumbnail,v=s.timestamp,b=s.stock,console.log(t.body),m=n.push({title:d,description:l,code:p,price:f,thumbnail:h,timestamp:v,stock:b,id:a}),e.json(m)):n.length>0&&(u=n[r.length-1].id,a=u+1,c=t.body,d=c.title,l=c.description,p=c.code,f=c.price,h=c.thumbnail,v=c.timestamp,b=c.stock,m=n.push({title:d,description:l,code:p,price:f,thumbnail:h,timestamp:v,stock:b,id:a}),e.json(m)),[2]}}))}))},e.getById=function(t,e){return n(void 0,void 0,void 0,(function(){var r,n,s,u;return o(this,(function(o){switch(o.label){case 0:return[4,i.default.promises.readFile("../../scr/db/products.txt","utf-8")];case 1:return r=o.sent(),n=JSON.parse(r),s=Number(t.params.id),n.length>0?isNaN(s)?e.status(400).json({error:"El ID debe ser un número!"}):(u=n.find((function(t){return t.id===s})))?e.status(200).json(u):e.status(404).json({error:"Producto no encontrado!"}):e.status(404).json({error:"No existen productos"}),[2]}}))}))},e.updateProduct=function(t,e){return n(void 0,void 0,void 0,(function(){var r,n,u,a,c,d,l,p,f,h;return o(this,(function(o){switch(o.label){case 0:return[4,i.default.promises.readFile("../../scr/db/products.txt","utf-8")];case 1:return r=o.sent(),n=JSON.parse(r),u=Number(t.params.id),n.length>0?isNaN(u)?e.status(400).json({error:"El ID debe ser un número"}):(a=n.find((function(t){return t.id==u})),c=n.filter((function(t){return t.id!==u})),a?(d=t.body,l=d.title,p=d.price,f=d.thumbnail,h={id:u,title:l,price:Number(p),thumbnail:f},n=s(s([],c,!0),[h],!1),e.status(200).send("Producto actualizada!")):e.status(404).json({error:"Producto no encontrada"})):e.status(404).json({error:"No existen productos"}),[2]}}))}))},e.deleteById=function(t,e){return n(void 0,void 0,void 0,(function(){var r,n,s,u;return o(this,(function(o){switch(o.label){case 0:return[4,i.default.promises.readFile("../../scr/db/products.txt","utf-8")];case 1:return r=o.sent(),n=JSON.parse(r),s=Number(t.params.id),n.length>0?isNaN(s)?e.status(400).json({error:"El ID debe ser un número"}):(u=n.filter((function(e){return e.id!=t.params.id})),n=u,e.status(200).send("Película eliminada!")):e.status(404).json({error:"No existen películas"}),[2]}}))}))}},105:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.router=void 0;var n=r(562),o=(0,r(860).Router)();e.router=o;var s=function(t,e,r){return r()};o.get("/products",n.getProducts),o.get("/products/:id",n.getById),o.post("/products",s,n.addProducts),o.put("/products/:id",s,n.updateProduct),o.delete("/products/:id",s,n.deleteById)},835:function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(860)),s=r(105),u=(0,o.default)();u.use(o.default.json()),u.use(o.default.urlencoded({extended:!0})),u.use("/api",s.router),u.use((function(t,e,r){var n={error:"-2",descripcion:"ruta: ".concat(t.url," método: ").concat(t.method," no implementado")};e.status(404).json(n),r()})),u.listen(8080,(function(){return console.log("Server listening on port: ".concat(8080))})).on("error",(function(t){return console.log("Oh no! Something is broken on the server: ".concat(t))}))},860:t=>{t.exports=require("express")},147:t=>{t.exports=require("fs")}},e={};!function r(n){var o=e[n];if(void 0!==o)return o.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,r),s.exports}(835)})();